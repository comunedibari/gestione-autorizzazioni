/*
 *    Date: 
 *  Author: 
 * Project: 
 *
 * 
 */

var RULE = "sendNoticeToApp";
var rlCfg = require("config/rleConf.json");

/*
 * opt -> {clt, cfg, log, data}
 * callback -> function(err,res)
 */
exports.run = function(opt,callback)
{

  if (rlCfg.enabled)
  {
    var erOpt = {
      host: opt.cfg.EReader.host,
      port: opt.cfg.EReader.port,
      path: "/notice/master",
      headers: {
        [opt.cfg.Auth.cookieName]: opt.cfg.Auth.innerToken,
        "content-type": "application/json"
      }
    };

    opt.clt.get(erOpt,function(errResNotice)
    {
      if (!errResNotice)
      {
        var msg = RULE+" - Cannot send notice to app"
        opt.log.info(msg);
        callback({message:msg},null);
        return;
      }

      callback(null,errResNotice)
    });
  }
  else
  {
    var msg = RULE+" - Not enabled"
    opt.log.info(msg);
    callback({message:msg},null);
    return;
  }

}

/*
 * Private function
 */